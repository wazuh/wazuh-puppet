
<vulnerability-detector>
  <% if @vulnerability_detector_enabled %><enabled><%= @vulnerability_detector_enabled %></enabled><% end %>
  <% if @vulnerability_detector_interval %><interval><%= @vulnerability_detector_interval %></interval><% end %>
  <% if @vulnerability_detector_run_on_start %><run_on_start><%= @vulnerability_detector_run_on_start %></run_on_start><% end %>
  <% if @vulnerability_detector_min_full_scan_interval %><min_full_scan_interval><%= @vulnerability_detector_min_full_scan_interval %></min_full_scan_interval><% end %>
<% if @vulnerability_detector_provider_canonical %>
  <provider name="canonical">
    <% if @vulnerability_detector_provider_canonical_enabled %><enabled><%= @vulnerability_detector_provider_canonical_enabled %></enabled><% end %>
    <% if !@vulnerability_detector_provider_canonical_os.empty? %>
    <% @vulnerability_detector_provider_canonical_os.each do |os| %>
    <os><%= os %></os>
    <% end %>
    <% end %>
    <% if @vulnerability_detector_provider_canonical_update_interval %><update_interval><%= @vulnerability_detector_provider_canonical_update_interval %></update_interval><% end %>
  </provider>
<% end %>
<% if @vulnerability_detector_provider_debian %>
  <provider name="debian">
    <% if @vulnerability_detector_provider_debian_enabled %><enabled><%= @vulnerability_detector_provider_debian_enabled %></enabled><% end %>
    <% if !@vulnerability_detector_provider_debian_os.empty? %>
    <% @vulnerability_detector_provider_debian_os.each do |os| %>
    <os><%= os %></os>
    <% end %>
    <% end %>
    <% if @vulnerability_detector_provider_debian_update_interval %><update_interval><%= @vulnerability_detector_provider_debian_update_interval %></update_interval><% end %>
  </provider>
<% end %>
<% if @vulnerability_detector_provider_redhat %>
  <provider name="redhat">
    <% if @vulnerability_detector_provider_redhat_enabled %><enabled><%= @vulnerability_detector_provider_redhat_enabled %></enabled><% end %>
    <% if @vulnerability_detector_provider_redhat_update_from_year %><update_from_year><%= @vulnerability_detector_provider_redhat_update_from_year %></update_from_year><% end %>
    <% if @vulnerability_detector_provider_redhat_update_interval %><update_interval><%= @vulnerability_detector_provider_redhat_update_interval %></update_interval><% end %>
    <% if !@vulnerability_detector_provider_redhat_os.empty? %>
    <% @vulnerability_detector_provider_redhat_os.each do |os| %>
    <os><%= os %></os>
    <% end %>
    <% end %>
  </provider>
<% end %>
<% if @vulnerability_detector_provider_nvd %>
  <provider name="nvd">
    <% if @vulnerability_detector_provider_nvd_enabled %><enabled><%= @vulnerability_detector_provider_nvd_enabled %></enabled><% end %>
    <% if @vulnerability_detector_provider_nvd_update_from_year %><update_from_year><%= @vulnerability_detector_provider_nvd_update_from_year %></update_from_year><% end %>
    <% if @vulnerability_detector_provider_nvd_update_interval %><update_interval><%= @vulnerability_detector_provider_nvd_update_interval %></update_interval><% end %>
  </provider>   
<% end %>
</vulnerability-detector>
  