
<%- if @kernel == 'Linux' -%>
<%- if @apply_template_os =='amazon' -%> 
<sca>
  <% if @sca_amazon_enabled -%>
  <enabled><%= @sca_amazon_enabled %></enabled>
  <%- end -%>
  <% if @sca_amazon_scan_on_start -%>
  <scan_on_start><%= @sca_amazon_scan_on_start %></scan_on_start>
  <%- end -%>
  <% if @sca_amazon_interval -%>
  <interval><%= @sca_amazon_interval %></interval>
  <%- end -%>
  <% if @sca_amazon_skip_nfs -%>
  <skip_nfs><%= @sca_amazon_skip_nfs %></skip_nfs>
  <%- end -%>
  
  <% if !@sca_amazon_policies.empty? -%>
  <policies>
  <% @sca_amazon_policies.each do |policy| -%>
      <policy><%= policy %></policy>
  <%- end -%>
  </policies>
  <%- end -%>
</sca>
<%- elsif @apply_template_os =='rhel' -%> 
<sca>
  <% if @sca_rhel_enabled -%>
  <enabled><%= @sca_rhel_enabled %></enabled>
  <%- end -%>
  <% if @sca_rhel_scan_on_start -%>
  <scan_on_start><%= @sca_rhel_scan_on_start %></scan_on_start>
  <%- end -%>
  <% if @sca_rhel_interval -%>
  <interval><%= @sca_rhel_interval %></interval>
  <%- end -%>
  <% if @sca_rhel_skip_nfs -%>
  <skip_nfs><%= @sca_rhel_skip_nfs %></skip_nfs>
  <%- end -%>
  
  <% if !@sca_rhel_policies.empty? -%>
  <policies>
  <% @sca_rhel_policies.each do |policy| -%>
      <policy><%= policy %></policy>
  <%- end -%>
  </policies>
  <%- end -%>
</sca>
<%- else -%>
<sca>
  <% if @sca_else_enabled -%>
  <enabled><%= @sca_else_enabled %></enabled>
  <%- end -%>
  <% if @sca_else_scan_on_start -%>
  <scan_on_start><%= @sca_else_scan_on_start %></scan_on_start>
  <%- end -%>
  <% if @sca_else_interval -%>
  <interval><%= @sca_else_interval %></interval>
  <%- end -%>
  <% if @sca_else_skip_nfs -%>
  <skip_nfs><%= @sca_else_skip_nfs %></skip_nfs>
  <%- end -%>
  
  <% if !@sca_else_policies.empty? -%>
  <policies>
  <% @sca_else_policies.each do |policy| -%>
      <policy><%= policy %></policy>
  <%- end -%>
  </policies>
  <policies>
  <%- if @debian_additional_templates == 'yes' -%>
    <policy>cis_debianlinux7-8_L1_rcl.yml</policy>
    <policy>cis_debianlinux7-8_L2_rcl.yml</policy>
  <%- end -%>
  </policies>
  <%- end -%>
</sca>
<%- end -%>
<%- elsif @kernel == 'windows' -%>
<sca>
  <% if @sca_windows_enabled -%>
  <enabled><%= @sca_windows_enabled %></enabled>
  <%- end -%>
  <% if @sca_windows_scan_on_start -%>
  <scan_on_start><%= @sca_windows_scan_on_start %></scan_on_start>
  <%- end -%>
  <% if @sca_windows_interval -%>
  <interval><%= @sca_windows_interval %></interval>
  <%- end -%>
  <% if @sca_windows_skip_nfs -%>
  <skip_nfs><%= @sca_windows_skip_nfs %></skip_nfs>
  <%- end -%>
  <% if !@sca_windows_policies.empty? -%>
  <policies>
  <% @sca_windows_policies.each do |policy| -%>
      <policy><%= policy %></policy>
  <%- end -%>
  </policies>
  <%- end -%>
</sca>
<%- end -%>
    
  
